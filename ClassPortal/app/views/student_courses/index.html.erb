<h1>Listing student_courses</h1>

<% @user = User.find(session[:id]) %>
<!% @student_courses = StudentCourse.all %>
<%if !params[:viewspecific] and !params[:course]%>
<table>
  <thead>
    <tr>
      <th>Course ID</th>
      <th>Student Email</th>
      <th>Grade</th>
      <th>Is Enrolled</th>
      <th>Has Requested Enrollment</th>
      <th>Enrollment Denied</th>
    </tr>
  </thead>
  <tbody>
    <% @student_courses.each do |student_course| %>
      <tr>
        <td><%= student_course.course_id %><br></td>
        <td><%= student_course.email %><br></td>
        <td><%= student_course.grade %><br></td>
        <td><%= student_course.is_curr_enrolled %><br></td>
        <td><%= student_course.has_requested %><br></td>
        <td><%= student_course.is_denied %><br></td>
        <td><%= link_to 'Edit', student_course, action: 'edit'%></td>
        <td><%= link_to 'History', controller: 'student_courses', action:  'index' , :viewspecific => true , :email => student_course.email %></td>
        <% if @user.is_admin %>
            <td><!%= link_to 'View user history', student_course, action: 'show'%></td>
            <td><%= link_to 'Destroy', student_course, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <%end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<% elsif params[:viewspecific] and !params[:course]%>
    <table>
      <thead>
      <tr>
        <th>Course ID</th>
        <th>Student Email</th>
        <th>Grade</th>
        <th>Is Enrolled</th>
        <th>Has Requested Enrollment</th>
        <th>Enrollment Denied</th>
      </tr>
      </thead>
      <tbody>
      <% @student_courses.each do |student_course| %>
          <tr>
            <%if params[:email] == student_course.email %>
              <td><%= student_course.course_id %><br></td>
              <td><%= student_course.email %><br></td>
              <td><%= student_course.grade %><br></td>
              <td><%= student_course.is_curr_enrolled %><br></td>
              <td><%= student_course.has_requested %><br></td>
              <td><%= student_course.is_denied %><br></td>
              <td><%= link_to 'Edit', student_course, action: 'edit'%></td>
            <% if @user.is_admin %>
                <td><!%= link_to 'View user history', student_course, action: 'show'%></td>
                <td><%= link_to 'Destroy', student_course, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            <%end %>
            <%end%>
          </tr>
      <% end %>
      </tbody>
    </table>

<% elsif !params[:viewspecific] and params[:course]%>

    <table>
      <thead>
      <tr>
        <th>Course ID</th>
        <th>Student Email</th>
        <th>Grade</th>
        <th>Is Enrolled</th>
        <th>Has Requested Enrollment</th>
        <th>Enrollment Denied</th>
      </tr>
      </thead>
      <tbody>
      <% @student_courses.each do |student_course| %>
          <tr>
            <%if params[:course] == student_course.course_id %>
                <td><%= student_course.course_id %><br></td>
                <td><%= student_course.email %><br></td>
                <td><%= student_course.grade %><br></td>
                <td><%= student_course.is_curr_enrolled %><br></td>
                <td><%= student_course.has_requested %><br></td>
                <td><%= student_course.is_denied %><br></td>
                <td><%= link_to 'Edit', student_course, action: 'edit'%></td>
                <% if @user.is_admin %>
                    <td><!%= link_to 'View user history', student_course, action: 'show'%></td>
                    <td><%= link_to 'Destroy', student_course, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                <%end %>
            <%end%>
          </tr>
      <% end %>
      </tbody>
    </table>
<%end%>

<% if @user.is_admin %>
    <%= link_to('Back', :controller => 'admin' , :action => 'index')%>
<% else%>
    <%= link_to('Back', :controller => 'instructor' , :action => 'index')%>
<%end%>
